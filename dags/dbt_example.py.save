from airflow import DAG
from airflow.operators.dummy_operator import DummyOperator
from airflow.operators.bash_operator import BashOperator
from airflow.operators.python_operator import PythonOperator
from airflow.version import version
from datetime import datetime, timedelta
from airflow.providers.airbyte.operators.airbyte import AirbyteTriggerSyncOperator
from airflow.utils.dates import days_ago
from airflow_dbt.operators.dbt_operator import (
    DbtSeedOperator,
    DbtSnapshotOperator,
    DbtRunOperator,
    DbtTestOperator
)


# Using a DAG context manager, you don't have to specify the dag property of each task

cmd = DbtRunOperator

default_args = {
	'dir' = '/home/dev/dbt'
}

with DAG(dag_id='dbt_aprendizes', default_args=default_args, schedule_interval='@daily') as dag:

	dbt_run= DbtRunOperator(
	  task_id='dbt_run',
	)
  
	dbt_test = DbtTestOperator(
	  task_id='dbt_test',
	  retries=0,
	)

dbt_run >> dbt_test


